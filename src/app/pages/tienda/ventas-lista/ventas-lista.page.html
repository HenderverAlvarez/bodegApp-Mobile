
<ion-content [fullscreen]="true">
  
<ion-refresher slot="fixed" (ionRefresh)="getVentas($event)">
  <ion-refresher-content></ion-refresher-content>
</ion-refresher>
  <app-header title="Todas las ventas"></app-header>
  
  <ion-grid class="margin-top-4">
    <ion-row class="ion-justify-content-space-between position-relative">
      <div class="wave-inv"></div>

      <ion-col size="auto" class="margin-top-4">
        <div>
          <ion-chip [routerLink]="['/inicio/tienda']" color="primary"><ion-icon class="margin-right-1" name="arrow-back"></ion-icon> Regresar</ion-chip>
        </div>
     </ion-col>


      <ion-col size="auto" class="margin-top-4">
        <ion-icon (click)="showHideFilters()" name="funnel-outline" size="large" color="primary"></ion-icon>
      </ion-col>
    </ion-row>

    <ion-row class="ion-justify-content-space-between margin-top-1" *ngIf="!showFilters">
      <ion-col size="auto" class="slide-in-right">
        <div class="filter-container">
          <ion-list>
            <ion-item>
              <ion-select interface="popover" [value]="selectedDate" (ionChange)="filter({'type': 'time','value': $event.target.value})" aria-label="Tiempo" placeholder="Tiempo">
                <ion-select-option value="">Hoy</ion-select-option>
                <ion-select-option value="dia">Ayer</ion-select-option>
                <ion-select-option value="semana">Esta semana</ion-select-option>
                <ion-select-option value="mes">Este mes</ion-select-option>
              </ion-select>
            </ion-item>
          </ion-list>
        </div>
        
      </ion-col>
      <ion-col size="auto" class="slide-in-left">
        <ion-list>
          <ion-item>
            <ion-select interface="popover" [value]="selectedEstado" 
            (ionChange)="filter({'type': 'estado','value': $event.target.value})" aria-label="Estado" placeholder="Estado de pago">
              <ion-select-option value="Pagado">Completado</ion-select-option>
              <ion-select-option value="Pendiente">Deuda</ion-select-option>
              <ion-select-option value="">Todos</ion-select-option>
            </ion-select>
          </ion-item>
        </ion-list>
      </ion-col>
    </ion-row>

    <ion-row class="ion-justify-content-center">
      <ion-col size="12">
        <ion-searchbar (ionInput)="filter({'type':'search','value':$event.target.value})" class="search" placeholder="Buscar venta por ID o cliente"></ion-searchbar>
      </ion-col>
    </ion-row>

    <ion-row class="ion-justify-content-center margin-top-4">
      <ion-col size="12" *ngIf="!loading">
        <ion-card *ngIf="!ventas" class="card-venta slide-in-left">
          <ion-card-header>
            <ion-card-title class="text-center text-primary text-small ">No se encontraron ventas con los criterios seleccionados</ion-card-title> 
          </ion-card-header>
        </ion-card>

        <card-venta *ngFor="let venta of ventas" [venta]="venta"></card-venta>

        <!--ion-card *ngFor="let venta of ventas" class="card-venta slide-in-left">
          <ion-card-header>
            <ion-card-title class="text-left text-primary text-small">ID: {{venta.uuid}} 
  
              <ion-chip *ngIf="venta.mora == 'No'" [color]="venta.estado == 'Pagado' ? 'primary' : 'warning'" class="margin-left-1">{{venta.estado}}</ion-chip>
  
              <ion-chip *ngIf="venta.mora == 'Si'" color="warning" class="margin-left-1">{{venta.estado}}</ion-chip>
            
            </ion-card-title> 
          </ion-card-header>
          <ion-card-content>
            <ion-row class="ion-justify-content-space-between">
                <ion-col size-sm="6" size-xs="12">
                  <ion-label class="text-small text-left w-100">Cliente: <span class=" text-primary">{{venta.nombre_cliente ? venta.nombre_cliente : "N/A"}}</span></ion-label>
                </ion-col>
                <ion-col size-sm="6" size-xs="12">
                  <ion-label class="text-small text-right w-100">Fecha: <span class=" text-primary">{{venta.fecha_creacion | date: 'dd-MM-yyyy'}}</span></ion-label>
                </ion-col>
            </ion-row>
  
            <ion-row class="ion-justify-content-space-between">
              <ion-col sizeSm="6" sizeXs="12">
                <ion-label class="text-small text-left w-100">Contacto: <span class=" text-primary">{{venta.contacto_cliente ? venta.contacto_cliente : "N/A"}}</span></ion-label>
              </ion-col>
              <ion-col size-sm="6" size-xs="12">
                <ion-label class="text-small text-right w-100">Hora: <span class=" text-primary">{{venta.fecha_creacion | date: 'HH:mm'}}</span></ion-label>
              </ion-col>
          </ion-row>
  
            <ion-row class="ion-justify-content-space-between">
              <ion-col size-sm="6" size-xs="12">
                <ion-label class="text-small text-right">Cantidad Items: <span class=" text-primary">{{venta.lines}}</span></ion-label>
              </ion-col>
              <ion-col size-sm="6" size-xs="12">
                <ion-label class="text-small text-left">Total Bs: <span class=" text-primary">{{venta.total}}</span></ion-label>
              </ion-col>
            </ion-row>  
            
            
          </ion-card-content>
        </ion-card-->
      </ion-col>

      <ion-col size="auto" *ngIf="loading">
        <ion-spinner color="primary" name="crescent" ></ion-spinner>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
